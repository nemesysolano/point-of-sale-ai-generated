CREATE TABLE PRODUCTS(
	PRODUCT_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
	PRODUCT_NAME NVARCHAR2(64) NOT NULL,
	CONSTRAINT PRODUCTS_PK PRIMARY KEY (PRODUCT_ID)
);

CREATE TABLE WAREHOUSES (
	WAREHOUSE_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
	WAREHOUSE_NAME NVARCHAR2(128) NOT NULL,
	CONSTRAINT WAREHOUSES_PK PRIMARY KEY (WAREHOUSE_ID)		
);

CREATE TABLE INVENTORY_ITEMS (
	WAREHOUSE_ID NUMBER NOT NULL,
	PRODUCT_ID NUMBER NOT NULL,
	SHELF_NUMBER NUMBER NOT NULL, -- SHELF_NUMBER IS a non zero integer lower than 4.
	RACK_NUMBER NUMBER NOT NULL, -- RACK_NUMBER IS a non zero integer lower than 20.
	ON_HAND_QUANTITY NUMBER(8,0) NOT NULL, -- ON_HAND_QUANTITY IS a non zero integer.
	MINIMUM_QUANTITY NUMBER(8,0) NOT NULL, -- MINIMUM_QUANTITY IS a non zero integer.
	CONSTRAINT INVENTORY_ITEMS_PK PRIMARY KEY (WAREHOUSE_ID, PRODUCT_ID, SHELF_NUMBER, RACK_NUMBER),
	CONSTRAINT INVENTORY_ITEMS_FK1 FOREIGN KEY (WAREHOUSE_ID) REFERENCES WAREHOUSES(WAREHOUSE_ID),
	CONSTRAINT INVENTORY_ITEMS_FK2 FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS(PRODUCT_ID)

);

CREATE TABLE INVENTORY_REQUISITION(
	INVENTORY_REQUISITION_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
	REQUISITION_DATE TIMESTAMP NOT NULL,
	WAREHOUSE_ID NUMBER NOT NULL,
	CONSTRAINT INVENTORY_REQUISITION_PK PRIMARY KEY (INVENTORY_REQUISITION_ID),
	CONSTRAINT INVENTORY_REQUISITION_FK1 FOREIGN KEY (WAREHOUSE_ID) REFERENCES WAREHOUSES(WAREHOUSE_ID)
);

CREATE TABLE INVENTORY_REQUISITION_ITEM(
	INVENTORY_REQUISITION_ITEM_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
	INVENTORY_REQUISITION_ID NUMBER NOT NULL,
	REQUESTED_QUANTITY NUMBER NOT NULL, --REQUESTED_QUANTITY IS a non zero integer lower than 100 
	APPROVED_QUANTITY NUMBER NOT NULL, --REQUESTED_QUANTITY IS a non zero integer lower than REQUESTED_QUANTITY,
	CONSTRAINT INVENTORY_REQUISITION_ITEM_PK PRIMARY KEY (INVENTORY_REQUISITION_ITEM_ID),
	CONSTRAINT INVENTORY_REQUISITION_ITEM_FK1 FOREIGN KEY (INVENTORY_REQUISITION_ID) REFERENCES INVENTORY_REQUISITION(INVENTORY_REQUISITION_ID)
);


CREATE TABLE SUPPLIERS(
	SUPPLIER_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
	SUPPLIER_NAME NVARCHAR2(128) NOT NULL,
	CONSTRAINT SUPPLIERS_PK PRIMARY KEY (SUPPLIER_ID)
);


CREATE TABLE PURCHASE_ORDER(
	PURCHASE_ORDER_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
	SUPPLIER_ID NUMBER NOT NULL,
	PURCHASE_ORDER_DATE TIMESTAMP NOT NULL,
	CONSTRAINT PURCHASE_ORDER_PK PRIMARY KEY (PURCHASE_ORDER_ID),
	CONSTRAINT PURCHASE_ORDER_FK1 FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIERS(SUPPLIER_ID)
);


CREATE TABLE PURCHASE_ORDER_ITEM (	
	INVENTORY_REQUISITION_ITEM_ID NUMBER NOT NULL,
	PURCHASE_ORDER_ID NUMBER NOT NULL,
	QUANTITY NUMBER NOT NULL, --REQUESTED_QUANTITY IS a non zero integer lower or equals than the APPROVED_QUANTITY in the INVENTORY_REQUISITION_ITEM referenced by INVENTORY_REQUISITION_ITEM_ID  
	CONSTRAINT PURCHASE_ORDER_ITEM_ITEM_UQ UNIQUE (INVENTORY_REQUISITION_ITEM_ID),
	CONSTRAINT PURCHASE_ORDER_ITEM_FK1 FOREIGN KEY(PURCHASE_ORDER_ID) REFERENCES PURCHASE_ORDER(PURCHASE_ORDER_ID)
);
